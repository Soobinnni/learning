# Docker 명령어

### 목차
1. <a href = "#a">도커 설치하기</a>
2. <a href = "#b">도커 버전 확인</a>
3. <a href = "#c">run</a>
4. <a href = "#d">exec</a>
5. <a href = "#e"></a>
6. <a href = "#f"></a>
7. <a href = "#g"></a>
8. <a href = "#h"></a>
9. <a href = "#i"></a>
10. <a href = "#j"></a>

<br>

## :star: <span id = "a">도커 설치하기</span>
1) 리눅스 

    `curl -s https://get.docker.com/ | sudo sh` 
    
    명령어 입력 > 패스워드 입력 > 리눅스 배포판에 따라 자동으로 최신 버전의 도커가 설치된다.

    우분투를 사용한다면,
    
    `sudo usrmod -aG docker ubuntu` 명령어로 그룹을 변경하여 도커 명령어를 사용할 수 있게 권한을 준다

2) MacOS or Windows

    Docker for Mac / Docker for Windows

    도커에서 공식으로 제공하는 프로그램을 설치한다.
    도커는 기본적으로 linux를 지원하기 때문에 MacOS와 Windows에 설치되는 Docker는 가상머신에 설치됨
    MacOS는 xhyve를 사용하고 Windows는 Hyper-V 사용

<br>

## :star: <span id = "b">도커 버전 확인</span>
```
    docker version
```

<br>

## :star: <span id = "c">run</span>
- 컨테이너 실행 명령어

    ```bash
    docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]
    ```


    :heart: OPTIONS
    - docker run 명령어에 전달할 옵션을 지정.

    :heart: IMAGE[:TAG|@DIGEST]
    - 실행할 Docker 이미지를 지정
    - IMAGE: Docker Hub 또는 로컬 Docker 레지스트리에서 사용 가능한 이미지 이름
    - TAG: 이미지의 버전 또는 태그를 지정. 이 부분을 생략하면 기본적으로 "latest" 태그를 사용
    - DIGEST: 이미지의 고유한 다이제스트 값을 사용하여 이미지를 지정. 다이제스트는 이미지의 내용을 나타내는 해시값

    :heart: COMMAND
    - 실행할 명령을 지정. 이것은 컨테이너 내에서 실행할 프로그램이나 스크립트의 경로 또는 명령어일 수 있음.
    - 이 부분을 생략하면 이미지의 기본 실행 명령이 실행
    - 명령은 컨테이너 시작 후에 실행될 것

    :heart: ARG
    - 필요한 경우 명령에 전달할 추가적인 인수나 옵션을 지정할 수 있음.
    - 이 부분은 [COMMAND]에 전달될 인수

    | option | description |
    | --- | --- |
    | -d | detached mode (백그라운드 모드)로, 백그라운드에서 컨테이너 내부의 명령을 실행하도록 함. 이렇게 하면 터미널을 차지하지 않고 다른 작업을 수행할 수 있음.  |
    | -p | 호스트와 컨테이너의 포트를 연결 |
    | -v | 호스트와 컨테이너의 디렉토리를 연결 |
    | -e | 컨테이너 내에서 사용할 환경변수 설정(실행 중인 명령에 환경 변수를 전달) |
    | --name | 컨테이너 이름 설정 |
    | --rm | 프로세스 종료시 컨테이너 자동 제거(컨테이너 실행이 완료되면 컨테이너를 자동으로 제거, 일회성 작업에 유용) |
    | -it | i와 -t를 동시에 사용한 것으로 터미널 입력을 위한 옵션 |
    | --network | 네트워크 연결 |

> 부연설명
- run 명령어를 사용하면 사용할 이미지가 저장되어 있는지 확인하고 없다면 다운로드 (pull) 한 후 컨테이너를 생성(create)하고 시작(start)
- 도커 이미지마다 컨테이너가 만들어질때 실행할 명령어를 지정할 수 있음
- `docker run ubuntu:20.04` 명령어 이후 컨테이너가 바로 종료되는 이유?
  - 명령어로 컨테이너는 정상적으로 실행됐지만 컨테이너는 ***프로세스***이기 때문에 해당 명령어로는 생성 이후 실행중인 프로세스가 없으므로 컨테이너는 생성되자마자 종료되게 된다.
- `docker run --rm -it ubuntu:20.04 /bin/sh`
  - 컨테이너 내부에 들어가기 위해 sh를 실행하고 키보드 입력을 위해 -it 옵션 추가 > 우분투 컨테이너 쉘이 보임
  - 추가적으로 프로세스가 종료되면 컨테이너가 자동으로 삭제되도록 --rm 옵션도 추가
  - --rm 옵션이 없다면 컨테이너가 종료되더라도 삭제되지 않고 남아 있어 수동으로 삭제해야 함
    - 컨테이너는 실행 중 | 멈춤 | 없음 상태가 있는데,, --rm옵션 없이 exit한 경우 멈추게 되고 필요하다면 재접속이 가능함

<br>

 - ***`-p 옵션`***

    ``` shell
        -p 호스트포트:컨테이네포트
    ```   

    - 컨테이너의 포트와 호스트의 포트 간의 포트 매핑을 설정하는 데 사용.

    - 컨테이너 내에서 실행 중인 애플리케이션의 포트를 호스트 시스템의 포트와 연결하여 외부에서 컨테이너의 애플리케이션에 액세스할 수 있게 한다.

    예시 

        docker run -p 8080:80 my-web-app
        docker run --rm -p 5678:5678 hashicorp/http-echo -text="hello world"
    - 호스트의 8080 포트를 컨테이너 내의 80 포트로 매핑합니다. 
    - 따라서 호스트 시스템에서 8080 포트로 접속하면 해당 요청이 컨테이너 내의 80 포트로 전달되며, 컨테이너 내의 웹 애플리케이션에 액세스할 수 있음.

<br>

  


## :star: <span id = "d">exec</span>

- **실행 중인** Docker 컨테이너에 접속하여 그 내에서 추가적인 프로세스나 명령을 실행하도록 하는 Docker 명령어
- 해당 명령어로 컨테이너 내부에 ssh 서버 등을 설치하지 않고 컨테이너 내부 환경에서 작업을 수행할 수 있음
  
        docker exec [OPTIONS] CONTAINER COMMAND [ARG...]


    :heart: OPTIONS
    - docker exec 명령어에 전달할 옵션을 지정.

    :heart: CONTAINER
    - 명령을 실행할 Docker 컨테이너의 이름이나 ID를 지정.

    :heart: COMMAND
    - 실행할 명령을 지정. 이것은 컨테이너 내에서 실행할 프로그램이나 스크립트의 경로 또는 명령어일 수 있음.

    :heart: ARG
    - 필요한 경우 명령에 전달할 추가적인 인수나 옵션을 지정할 수 있음.

    | option | description |
    | --- | --- |
    | -it | i와 -t를 동시에 사용한 것으로 터미널 입력을 위한 옵션 |
    | --user | 실행할 사용자를 지정. 사용자를 UID 또는 사용자 이름으로 지정할 수 있음 |
    | --workdir 또는 -w | 작업 디렉토리를 지정. 명령이 실행될 때 컨테이너 내부의 현재 작업 디렉토리를 변경함 |
    | -e | 컨테이너 내에서 사용할 환경변수 설정(실행 중인 명령에 환경 변수를 전달) |
    | -d | detached mode (백그라운드 모드)로, 백그라운드에서 컨테이너 내부의 명령을 실행하도록 함. 이렇게 하면 터미널을 차지하지 않고 다른 작업을 수행할 수 있음. |
    | --rm | 프로세스 종료시 컨테이너 자동 제거(컨테이너 실행이 완료되면 컨테이너를 자동으로 제거, 일회성 작업에 유용) |
    | --name | 컨테이너에 이름을 지정 |
    | --network | 네트워크 연결 |
    | --help | 도움말 메시지를 표시하고 사용 가능한 옵션과 명령어에 대한 설명을 확인 가능. |

- 예시
  
  (1) MySQL클라이언트 접속
  
      docker exec -it mysql mysql

  -  --name옵션으로 지정해둔 이름인 mysql(전자) 컨테이너에 접속, mysql(후자)라는 실행 명령어를 실행함
  - 해당 명령어로, mysql 클라이언트에 접속하게 된다.


  (2) "mycontainer"라는 이름의 Docker 컨테이너에서 Bash 셸을 실행

        docker exec -it mycontainer /bin/bash

  -  "mycontainer"라는 컨테이너 내에서 대화형으로 Bash 셸을 실행, -it 옵션으로 터미널 상호작용을 가능하게 함.



