# Docker
    컨테이너 기술을 사용하여 애플리케이션과 그 종속성을 패키지화하고 배포하기 위한 플랫폼 및 도구

<br>


:star: **이미지 기반 애플리케이션 배포**

- 애플리케이션 실행에 필요한 환경은 이미지로 패키징되어, 다양한 환경에서 동일한 환경으로 애플리케이션을 실행할 수 있다.

<br>

:star: **컨테이너화**
- 컨테이너는 독립된 가상 환경에 운영 체제와 응용 프로그램을 설치하여, 외부 환경과는 분리된 독립적인 실행 환경을 제공하며 이를 통해 프로세스들이 동일한 방식으로 컨테이너 내에서 실행될 수 있다.

<br>

:star: **확장성/이식성**
- 도커가 설치되어 있다면 어디서든 컨테이너를 설치할 수 있다.
- 쉽게 개발 서버를 만들 수 있고 테스트 서버 생성도 간편하다.

<br>

:star: **표준성**
- 도커를 사용하지 않는 경우 ruby, node.js, go, php로 만든 서비스들의 배포 방식은 각각 다름.
- 컨테이너라는 표준으로 서버를 배포하므로 모든 서비스들의 배포 과정이 동일해짐
  - `docker-compose-up` 명령어 하나로 실행이 가능

<br>

:star: **설정관리**
- 설정은 보통 환경변수로 제어하며 MYSQL_PASS=password와 같이 컨테이너를 띄울 때 환경변수를 같이 지정한다.
- 하나의 이미지가 환경변수에 따라 동적으로 설정파일을 생성하도록 만들어져야 한다.

<br>

:star: **자원관리**
- 컨테이너는 삭제 후 새로 만들면 모든 데이터가 초기화되므로 업로드 파일을 외부 스토리지와 링크하여 사용하거나 S3와 같은 별도의 저장소가 필요하다
- 세션이나 캐시를 memcached나 redis와 같은 외부로 분리한다.

<br>

:star: **그 외**
- 컨테이너 이미지를 빌드하고 관리하며, 컨테이너를 만들고(실행하고) 배포하기 위한 다양한 명령어 및 도구를 제공.
- 이미지 빌드 기록이 남는다.
- 코드와 설정으로 관리하므로 재현 및 수정이 가능
- 오픈소스이므로 특정 회사 기술에 종속적이지 않음

<br><br>

## Docker Host
- 도커 컨테이너가 실행되는 물리적인 또는 가상화된 서버 또는 컴퓨터 시스템
  - 호스트와 컨테이너 간의 관계는 컨테이너 가상화 기술을 기반


- 도커 컨테이너는 호스트 시스템 위에서 독립적인 실행 환경을 가지고 동작하며, 호스트 시스템의 운영 체제 커널을 공유하면서 격리된 환경인 컨테이너를 실행

- 호스트 시스템은 도커 데몬을 실행하고, 도커 이미지를 저장하며, 컨테이너를 실행하고 관리. 
- 컨테이너는 호스트 시스템의 자원(CPU, 메모리, 저장소)을 공유하며, 호스트의 네트워크를 이용하여 통신. 
- 호스트는 도커 컨테이너의 런타임 환경을 제공하고, 컨테이너가 격리된 프로세스 공간을 가지도록 함
  
<br>

## Docker <a href="https://github.com/Soobinnni/learning/blob/main/Demon.md">Demon</a>
        도커의 핵심 백그라운드 서비스로, 도커 엔진(Docker Engine)이라고도 함 
        도커 컨테이너의 생성, 실행, 관리, 이미지 빌드, 네트워킹, 데이터 볼륨 관리 등의 모든 핵심 기능을 제공하고 관리하는 프로세스.

***:heart:역할***

:star:. **컨테이너 관리**
- 라이프사이클을 관리하며, 컨테이너의 생성, 시작, 중지, 삭제 및 모니터링을 담당

:star:. **이미지 관리**
- 도커 이미지의 저장, 다운로드, 빌드 및 관리를 처리
- 데몬은 이미지를 로컬 레지스트리에서 가져오고 관리

:star:. **네트워크 관리** 
- 컨테이너 간 또는 컨테이너와 호스트 간의 네트워킹을 설정하고 관리 > 이를 통해 컨테이너 간의 통신과 호스트와의 통신이 가능해짐

:star:. **데이터 볼륨 관리**
- 데이터 볼륨을 생성하고 관리하여 컨테이너 간에 데이터를 공유하고 보존하는데 사용.

:star:. **보안 및 격리**
- 컨테이너 간의 격리를 보장하고, 컨테이너와 호스트 시스템 간의 보안을 유지.

:star:. **API 및 클라이언트 상호작용**
- 데몬은 도커 클라이언트와 상호작용하고, 사용자와 도커 서비스 간의 통신을 중계.
- 사용자가 도커 명령을 실행하면 도커 클라이언트가 데몬에 명령을 전달하고, 데몬은 해당 명령을 수행 > 이를 통해 사용자는 컨테이너 및 이미지를 관리하고 도커 환경을 조작할 수 있음


<br><br>

## Docker를 이해하기 위한 개념들
- Dockerfile, Image, Docker Container
- :bulb: 이미지를 빌드하기 위한 Dockerfile을 생성 -> Image 생성 -> Image를 기반으로 한 Docker Container 생성
  
### | Dockerfile
- 이미지를 빌드하기 위한 지침을 포함하는 텍스트 파일

        어떤 애플리케이션을 컨테이너로 패키지화할지
        어플리케이션을 구동하기 위해 필요한 파일
        필요한 외부 라이브러리 명시
        환경 변수에 대해 설정
        기본 이미지 선택
        애플리케이션 설치
        어떻게 구동해야하는 지 스크립트

### | Image
- Dockerfile에 정의된 내용을 기반으로 빌드
- 컨테이너 실행에 필요한 파일 및 설정을 포함하는 정적 스냅샷(==만들어진 이미지는 변경 불가능)
- 이미지는 애플리케이션 및 종속성을 포함하며, 여러 컨테이너에서 공유하여 사용
- 이미지는 Docker 레지스트리에 저장될 수 있음

        이미지는 필요한 코드, 런타임 환경, 시스템 툴, 
        시스템 라이브러리 등 모든 세팅들이 포함되고 있음

### | Docker Container
- Docker 이미지의 인스턴스로, 실행 중인 애플리케이션을 포함
- 컨테이너는 이미지를 실행하여 격리된 환경에서 애플리케이션을 실행하고 관리
- 컨테이너는 호스트 운영 체제와 커널을 공유하며, 이미지를 기반으로 작동 
- Docker 컨테이너는 가벼우면서 빠르게 시작할 수 있으며, 이식성이 뛰어남

<br>

## 비교를 통한 정리
- 이미지 cf. 객체지향 프로그래밍 언어에서의 Class
- 컨테이너 cf. 그 Class가 instance화된 것
- 동작하고 있는 어플리케이션을 스냅샷하여 템플릿 형태로 이미지를 만들어두고, 이 클래스 즉 이미지를 이용하여 실제로 어플리케이션이 동작하는 각각의 컨테이너를 만들 수 있음
- 이미지는 우리가 캡쳐했을 당시의 그 프로젝트 상태를 불변의 상태를 가지고 있기 때문에 프로젝트 내부적인 것이 변경되더라도 영향(변경)을 받지 않는다.

<br>

## ***Container Registry***
- 도커는 컨테이너 이미지 레지스트리를 제공하여 컨테이너를 쉽게 다룰 수 있는 도구를 제공


        Container Registry

        [Local Machine] -PUSH-> [hub -PULL] -> [Other Server]


- docker hub가 그 예 중 하나, Docker 이미지는 Docker hub 이라는 플랫폼 서비스에서 사용자끼리 서로 공유할 수 있다.

<br>

## 도커에서의 작업 흐름
1. 빌드 서버에서 이미지 빌드: 애플리케이션 코드와 Dockerfile을 사용하여 도커 이미지를 빌드. 이 빌드 서버는 개발 환경이나 CI/CD 파이프라인에서 사용될 수 있다.

2. 이미지 저장소에 이미지 저장: 빌드한 도커 이미지는 이미지 저장소에 업로드(Docker hub와 같은 저장소에 푸시)

3. 운영 서버에서 이미지 불러오기: 운영 환경의 도커 호스트(운영 서버)에서는 이미지 저장소에서 필요한 이미지를 다운로드(풀)하여 실행.


<br>

## 도커 아키텍처

![도커_client_server](https://github.com/Soobinnni/learning/assets/111328823/ad3e5426-48c1-4e2d-95b4-52a727924cfa)

도커는 클라이언트와 서버로 나뉘어 있는 프로그램으로 도커 아키텍처는 Client와 Server 구성으로 되어 있다. docker CLI는 도커 호스트에 명령을 전달하고 결과를 받아서 출력함.

도커 클라이언트와 서버 간의 통신은 주로 로컬 호스트에서 이루어지지만, 원격 서버에 도커 서버를 호스팅하고 원격 도커 클라이언트와 통신할 수도 있다. 

이러한 클라이언트-서버 모델은 도커를 사용하여 컨테이너를 관리하고 배포하는 데 중요한 역할을 함.

<br>

:heart: **도커 클라이언트(Docker Client)**
- 프로그램이나 명령어를 의미
- 사용자(개발자 등)가 도커와 상호작용하기 위한 도구 즉 인터페이스로, 명령줄 도구인 docker 명령어나 도커 API를 호출할 수 있는 다양한 도구와 라이브러리를 포함
- 도커 클라이언트는 도커 서버와 통신하며, 사용자 명령을 전달하고 서버로부터 응답을 받아서 작업을 수행함

:heart: **도커 서버(Docker Server)**
- 컨테이너 관리, 이미지 빌드, 네트워크 설정, 데이터 볼륨 관리 등의 핵심 서비스를 제공하는 백그라운드 프로세스 
- 도커 클라이언트의 명령을 수신하고 서버는 해당 명령을 실행하며 컨테이너와 이미지 관련 작업을 처리
- 컨테이너의 생애주기와 관리를 담당하며, 컨테이너 간의 격리를 유지.
